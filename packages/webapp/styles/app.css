@font-face {
  font-family: "Geist Sans";
  src: url("../../../node_modules/geist/dist/fonts/geist-sans/Geist-Variable.woff2") format("woff2");
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Geist Sans";
  src: url("../../../node_modules/geist/dist/fonts/geist-sans/Geist-Italic[wght].woff2") format("woff2");
  font-weight: 100 900;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "Geist Mono";
  src: url("../../../node_modules/geist/dist/fonts/geist-mono/GeistMono-Variable.woff2") format("woff2");
  font-weight: 100 900;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Geist Mono";
  src: url("../../../node_modules/geist/dist/fonts/geist-mono/GeistMono-Italic[wght].woff2") format("woff2");
  font-weight: 100 900;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "Geist Pixel Square";
  src: url("../../../node_modules/geist/dist/fonts/geist-pixel/GeistPixel-Square.woff2") format("woff2");
  font-display: swap;
}

*,
*::before,
*::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

:root {
  color-scheme: light dark;

  --bg: #F6F4F0;
  --fg: #1A1A1A;
  --fg-dim: #6B6560;
  --accent: #E63B12;
  --accent-hover: #C73210;
  --surface: white;
  --overlay: rgba(26, 26, 26, 0.4);
  --composer-bg: rgba(230, 226, 220, 0.75);
  --border-subtle: rgba(26, 26, 26, 0.2);
  --border-subtle-hover: rgba(26, 26, 26, 0.4);
  --hover-tint: rgba(0, 0, 0, 0.04);
  --disabled-bg: rgba(26, 26, 26, 0.15);

  --cream: var(--bg);
  --black: var(--fg);
  --red: var(--accent);
  --red-hover: var(--accent-hover);
  --text: var(--fg);
  --text-dim: var(--fg-dim);

  --border-thick: 3px solid var(--fg);
  --border-thin: 1px solid var(--fg);
  --shadow: 5px 5px 0 var(--fg);
  --shadow-sm: 3px 3px 0 var(--fg);
  --column-color: var(--accent);

  --font-display: "Geist Pixel Square", "Geist Sans", sans-serif;
  --font-body: "Geist Pixel Square", "Geist Sans", sans-serif;
  --font-mono: "Geist Mono", monospace;
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg: #1A1A1A;
    --fg: #F6F4F0;
    --fg-dim: #9A9590;
    --accent: #E63B12;
    --accent-hover: #F04D26;
    --surface: #2A2A2A;
    --overlay: rgba(0, 0, 0, 0.6);
    --composer-bg: rgba(30, 28, 26, 0.85);
    --border-subtle: rgba(246, 244, 240, 0.15);
    --border-subtle-hover: rgba(246, 244, 240, 0.3);
    --hover-tint: rgba(255, 255, 255, 0.05);
    --disabled-bg: rgba(246, 244, 240, 0.1);
    --shadow: 5px 5px 0 rgba(0, 0, 0, 0.4);
    --shadow-sm: 3px 3px 0 rgba(0, 0, 0, 0.4);
  }
}

html,
body,
#root {
  height: 100%;
  width: 100%;
  background: var(--cream);
  color: var(--text);
  font-family: var(--font-body);
  font-size: 18px;
  line-height: 1.6;
}

/* ===================================================
   APP LAYOUT
   =================================================== */

.app {
  --content-inset: max(64px, calc((100vw - 960px) / 2));
  height: 100%;
  display: flex;
  position: relative;
  overflow: hidden;
}

/* Corner crop marks */
.app::before,
.app::after {
  content: "";
  position: fixed;
  z-index: 100;
  pointer-events: none;
}

.app::before {
  top: 14px;
  left: 14px;
  width: 20px;
  height: 20px;
  border-top: 2px solid var(--black);
  border-left: 2px solid var(--black);
}

.app::after {
  top: 14px;
  right: 14px;
  width: 20px;
  height: 20px;
  border-top: 2px solid var(--black);
  border-right: 2px solid var(--black);
}

/* Bottom crop marks — anchored above composer */

/* Vertical rotated label */
.vertical-label {
  position: fixed;
  left: 8px;
  top: 50%;
  font-family: var(--font-display);
  font-weight: 900;
  font-size: 11px;
  letter-spacing: 0.25em;
  text-transform: uppercase;
  color: var(--text-dim);
  white-space: nowrap;
  pointer-events: none;
  z-index: 100;
  writing-mode: vertical-rl;
  transform: rotate(180deg) translateX(50%);
}

/* Registration mark */
.registration-mark {
  position: fixed;
  z-index: 100;
  pointer-events: none;
  font-size: 10px;
  color: var(--text-dim);
  line-height: 1;
}

.registration-mark.top-center {
  top: 12px;
  left: 50%;
  transform: translateX(-50%);
}

.registration-mark.bottom-center {
  bottom: 12px;
  left: 50%;
  transform: translateX(-50%);
}

.chat-area {
  flex: 1;
  min-width: 0;
  height: 100%;
}

/* ===================================================
   THREAD LAYOUT
   =================================================== */

.thread-root {
  display: flex;
  flex-direction: column;
  height: 100%;
  position: relative;
}

.thread-viewport {
  flex: 1;
  overflow: auto;
  padding: 48px var(--content-inset) 160px;
  display: flex;
  flex-direction: column;
  gap: 0;
}

/* Scrollbar — minimal */
.thread-viewport::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}

.thread-viewport::-webkit-scrollbar-track {
  background: transparent;
}

.thread-viewport::-webkit-scrollbar-thumb {
  background: var(--black);
}

/* ===================================================
   EMPTY STATE
   =================================================== */

.thread-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  flex: 1;
  text-align: center;
  gap: 28px;
  padding: 48px 16px;
  position: sticky;
  left: 0;
}

.thread-empty-mark {
  font-family: var(--font-display);
  font-size: 12px;
  letter-spacing: 0.3em;
  text-transform: uppercase;
  color: var(--text-dim);
}

.thread-empty h2 {
  font-family: var(--font-display);
  font-size: 56px;
  font-weight: 900;
  color: var(--black);
  letter-spacing: -0.02em;
  text-transform: uppercase;
  line-height: 0.9;
}

.thread-empty-rule {
  width: 120px;
  height: 0;
  border: none;
  border-top: 3px solid var(--red);
}

.thread-empty p {
  font-family: var(--font-body);
  font-style: italic;
  font-size: 16px;
  max-width: 380px;
  color: var(--text-dim);
  line-height: 1.6;
}

.thread-empty-footer {
  font-family: var(--font-mono);
  font-size: 10px;
  letter-spacing: 0.15em;
  text-transform: uppercase;
  color: var(--text-dim);
  margin-top: 8px;
}

/* Empty state column preview strips */
.empty-columns-preview {
  display: flex;
  flex-direction: row;
  gap: 6px;
  margin-top: 8px;
}

.empty-column-strip {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  width: 40px;
  height: 240px;
  background: var(--column-color, var(--red));
  padding: 10px 0;
  transition: filter 0.15s ease;
}

.empty-column-strip.dimmed {
  filter: grayscale(1);
}

/* Preset picker */
.preset-picker {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 12px;
  margin-top: 20px;
}

.preset-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 6px;
  padding: 18px 28px;
  background: var(--surface);
  border: 1px solid var(--border-subtle);
  cursor: pointer;
  transition: border-color 0.15s;
  width: 320px;
  max-width: 100%;
}

.preset-card:hover {
  border-color: var(--border-subtle-hover);
}

.preset-card-label {
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--black);
}

.preset-card-meta {
  font-family: var(--font-mono);
  font-size: 11px;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: var(--text-dim);
}

.preset-card-desc {
  font-family: var(--font-body);
  font-style: italic;
  font-size: 13px;
  color: var(--text-dim);
  line-height: 1.5;
  text-align: center;
}

.preset-build-own {
  background: none;
  border: none;
  padding: 0;
  font-family: var(--font-mono);
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-dim);
  text-decoration: underline;
  text-underline-offset: 3px;
  cursor: pointer;
  transition: color 0.1s;
}

.preset-build-own:hover {
  color: var(--red);
}

/* ===================================================
   USER MESSAGE
   =================================================== */

.message-user {
  padding: 24px 0;
  position: sticky;
  left: 0;
}

.message-user-label {
  font-family: var(--font-display);
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  color: var(--red);
  margin-bottom: 8px;
}

.message-user-content {
  font-family: var(--font-body);
  font-size: 17px;
  line-height: 1.7;
  color: var(--black);
  white-space: pre-wrap;
}

/* ===================================================
   ASSISTANT MESSAGE (columns container)
   =================================================== */

.message-assistant {
  display: block;
  padding: 8px 0 32px;
  min-width: 0;
}

/* ===================================================
   COLUMNS LAYOUT — EXPANDED + HORIZONTAL STRIP
   =================================================== */

.columns-layout {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 16px;
}

.columns-grid {
  display: flex;
  flex-direction: row;
  gap: 12px;
  align-items: stretch;
  padding-bottom: 12px;
}

.columns-grid::after {
  content: "";
  flex: 0 0 var(--content-inset);
}

/* ===================================================
   COLUMN CARD — HORIZONTAL PANEL WITH VERTICAL BAR
   =================================================== */

.column-card {
  display: flex;
  flex-direction: row;
  background: color-mix(in srgb, var(--column-color, var(--accent)) 6%, var(--surface));
  border: 3px solid var(--column-color, var(--red));
  box-shadow: 4px 4px 0 var(--column-color, var(--red));
  min-height: 240px;
  max-height: 480px;
  flex: 0 0 400px;
  width: 400px;
  transition: filter 0.15s ease;
}

.column-card.expanded {
  flex: 0 0 auto;
  width: 100%;
  max-height: none;
  position: sticky;
  left: 0;
}

.column-card.loading {
  opacity: 0.65;
}

.column-card.dimmed {
  filter: grayscale(1);
}

/* Empty state card */
.empty-column-card {
  flex: 0 0 400px;
  width: 400px;
  min-height: 240px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px dashed var(--border-subtle);
  border-radius: 0;
  background: none;
  cursor: pointer;
  padding: 0;
  outline: none;
  font-family: var(--font-body);
  font-size: 13px;
  font-style: italic;
  color: var(--text-dim);
}

.empty-column-card:hover {
  border-color: var(--border-subtle-hover);
  color: var(--black);
}

/* Vertical name bar — always visible */
.column-card-bar {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: space-between;
  gap: 0;
  width: 40px;
  flex-shrink: 0;
  background: var(--column-color, var(--red));
  border: none;
  border-right: 2px solid var(--column-color, var(--red));
  cursor: pointer;
  padding: 10px 0;
  transition: background 0.1s;
}

.column-card-bar:hover {
  filter: brightness(0.85);
}

/* Column name — vertical text */
.column-card-bar-label {
  font-family: var(--font-display);
  font-size: 18px;
  font-weight: 800;
  text-transform: uppercase;
  letter-spacing: 0.15em;
  color: var(--cream);
  writing-mode: vertical-lr;
  text-orientation: mixed;
  white-space: nowrap;
}

/* Content area — everything right of the bar */
.column-card-content {
  flex: 1;
  min-width: 0;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Help button — inside the colored sidebar bar */
.prompt-hint-button {
  width: 22px;
  height: 22px;
  border: none;
  background: none;
  color: var(--bg);
  font-family: var(--font-mono);
  font-size: 13px;
  font-weight: 700;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  opacity: 0.7;
  transition: opacity 0.1s;
}

.prompt-hint-button:hover {
  opacity: 1;
}

/* Tooltip */
.prompt-tooltip {
  width: 340px;
  max-width: calc(100vw - 16px);
  max-height: 320px;
  overflow-y: auto;
  padding: 14px 16px;
  background: var(--surface);
  border: 3px solid var(--black);
  box-shadow: var(--shadow);
  color: var(--text);
  font-family: var(--font-mono);
  font-size: 11px;
  line-height: 1.6;
  white-space: pre-wrap;
  z-index: 200;
}

/* Body */
.column-card-body {
  flex: 1;
  padding: 10px 14px;
  overflow-y: auto;
  min-height: 0;
  scrollbar-gutter: stable;
}

.column-card-body::-webkit-scrollbar {
  width: 4px;
}

.column-card-body::-webkit-scrollbar-track {
  background: transparent;
  margin-top: 24px;
}

.column-card-body::-webkit-scrollbar-thumb {
  background: var(--column-color, var(--red));
  opacity: 0.5;
}

.column-card-value {
  font-family: var(--font-body);
  font-size: 17px;
  line-height: 1.6;
  color: var(--black);
  white-space: pre-wrap;
}

/* Bullet lists in column values get monospace treatment */
.column-card-value-mono {
  font-family: var(--font-mono);
  font-size: 12px;
  line-height: 1.65;
  color: var(--black);
  white-space: pre-wrap;
}

/* Spinner */
.column-card-spinner {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-dim);
  letter-spacing: 0.05em;
  text-transform: uppercase;
}

@keyframes pulse {
  0%,
  100% {
    opacity: 0.4;
  }
  50% {
    opacity: 1;
  }
}

.column-card.loading .column-card-spinner {
  animation: pulse 1.5s ease-in-out infinite;
}

/* Waiting state — terminal-style dep display */
.column-card-waiting {
  font-family: var(--font-mono);
  font-size: 11px;
  line-height: 1.7;
  color: var(--text-dim);
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.waiting-header {
  font-size: 10px;
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.waiting-deps {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.waiting-dep {
  display: flex;
  gap: 8px;
  align-items: baseline;
  animation: pulse 1.5s ease-in-out infinite;
}

.waiting-dep.done {
  animation: none;
  opacity: 0.5;
}

.waiting-dep-status {
  flex-shrink: 0;
  font-size: 10px;
}

.waiting-dep-name {
  font-size: 11px;
}

/* Footnote metadata */
.column-card-footnote {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding: 4px 14px 6px;
  border-top: 1px dashed var(--black);
  font-family: var(--font-mono);
  font-size: 9px;
  color: var(--text-dim);
  letter-spacing: 0.05em;
  text-transform: uppercase;
}

/* ===================================================
   FOCUS TINT — full-page color overlay in focus mode
   =================================================== */

.focus-tint {
  position: fixed;
  inset: 0;
  opacity: 0.06;
  pointer-events: none;
  z-index: 0;
}

/* ===================================================
   ERROR
   =================================================== */

.step-error {
  background: var(--surface);
  border: 3px solid var(--red);
  padding: 14px 18px;
  color: var(--red);
  font-family: var(--font-mono);
  font-size: 13px;
  line-height: 1.5;
  white-space: pre-wrap;
  word-break: break-word;
  box-shadow: var(--shadow-sm);
}

/* ===================================================
   COMPOSER — BRUTALIST SEARCH BAR
   =================================================== */

.composer-container {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 28px var(--content-inset) 28px;
  background: var(--composer-bg);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
}

.composer-container::before,
.composer-container::after {
  content: "";
  position: absolute;
  bottom: calc(100% + 14px);
  width: 20px;
  height: 20px;
  pointer-events: none;
}

.composer-container::before {
  left: 14px;
  border-bottom: 2px solid var(--black);
  border-left: 2px solid var(--black);
}

.composer-container::after {
  right: 14px;
  border-bottom: 2px solid var(--black);
  border-right: 2px solid var(--black);
}

.composer-root {
  display: flex;
  gap: 0;
  align-items: stretch;
}

.composer-input {
  flex: 1;
  background: transparent;
  border: 1px solid var(--border-subtle);
  border-right: none;
  border-radius: 6px 0 0 6px;
  padding: 14px 18px;
  color: var(--text);
  font-family: var(--font-body);
  font-size: 16px;
  line-height: 1.5;
  resize: none;
  outline: none;
  transition: border-color 0.15s;
}

.composer-input:focus {
  border-color: var(--border-subtle-hover);
}

.composer-input::placeholder {
  font-family: var(--font-body);
  font-style: italic;
  color: var(--text-dim);
  opacity: 0.6;
}

.composer-send {
  background: var(--black);
  color: var(--cream);
  border: 1px solid var(--border-subtle);
  border-left: none;
  border-radius: 0 6px 6px 0;
  padding: 14px 24px;
  font-family: var(--font-display);
  font-size: 13px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  cursor: pointer;
  transition: opacity 0.15s;
  white-space: nowrap;
}

.composer-send:hover:not(:disabled) {
  opacity: 0.8;
}

.composer-send:disabled {
  background: var(--disabled-bg);
  color: var(--text-dim);
  cursor: default;
}

/* Clear button — just underlined text */
.clear-button {
  margin-top: 10px;
  background: none;
  border: none;
  padding: 0;
  color: var(--text-dim);
  font-family: var(--font-mono);
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  text-decoration: underline;
  text-underline-offset: 3px;
  cursor: pointer;
  transition: color 0.1s;
}

.clear-button:hover:not(:disabled) {
  color: var(--red);
}

.clear-button:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

.composer-links {
  display: flex;
  gap: 16px;
  margin-top: 18px;
}

.composer-links .clear-button {
  margin-top: 0;
}


/* ===================================================
   CONFIG EDITOR — FULL PAGE
   =================================================== */

.config-editor {
  flex: 1;
  height: 100%;
  min-width: 0;
  display: flex;
  flex-direction: column;
  position: relative;
}

/* Crosshatch drafting-paper background */
.config-editor::before {
  content: "";
  position: absolute;
  inset: 0;
  background:
    repeating-linear-gradient(
      45deg,
      var(--fg) 0px,
      var(--fg) 1px,
      transparent 1px,
      transparent 10px
    ),
    repeating-linear-gradient(
      -45deg,
      var(--fg) 0px,
      var(--fg) 1px,
      transparent 1px,
      transparent 10px
    );
  opacity: 0.08;
  pointer-events: none;
  z-index: 0;
}

/* Draft mode banner */
.config-editor-banner {
  position: sticky;
  top: 0;
  left: 0;
  right: 0;
  z-index: 5;
  padding: 8px var(--content-inset);
  font-family: var(--font-display);
  font-size: 11px;
  font-weight: 700;
  letter-spacing: 0.2em;
  text-transform: uppercase;
  color: var(--fg);
  background: repeating-linear-gradient(
    -45deg,
    transparent 0px,
    transparent 4px,
    var(--fg) 4px,
    var(--fg) 5px
  );
  background-size: 100% 100%;
}

.config-editor-banner-text {
  display: inline-block;
  padding: 4px 10px;
  background: var(--bg);
}

.config-editor-row {
  flex: 1;
  display: flex;
  flex-direction: row;
  gap: 12px;
  overflow-x: auto;
  padding: 48px 0 160px var(--content-inset);
  align-items: stretch;
  position: relative;
  z-index: 1;
}

.config-editor-row::after {
  content: "";
  flex: 0 0 var(--content-inset);
}

.config-editor-row::-webkit-scrollbar {
  width: 4px;
  height: 4px;
}

.config-editor-row::-webkit-scrollbar-track {
  background: transparent;
}

.config-editor-row::-webkit-scrollbar-thumb {
  background: var(--black);
}

/* Add column button — dashed card after the last card */
.config-add-btn {
  flex: 0 0 auto;
  width: 48px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  border: 2px dashed var(--border-subtle);
  background: none;
  cursor: pointer;
  font-family: var(--font-display);
  font-size: 22px;
  font-weight: 700;
  color: var(--text-dim);
  transition: color 0.15s, border-color 0.15s, background 0.15s;
}

.config-add-btn:hover {
  border-color: var(--border-subtle-hover);
  color: var(--black);
  background: var(--hover-tint);
}

/* When the add button is the only element (0 columns) */
.config-add-btn-empty {
  flex: 0 0 400px;
  width: 400px;
}

.config-add-btn-label {
  font-family: var(--font-display);
  font-size: 16px;
  font-weight: 700;
  letter-spacing: 0.1em;
  text-transform: uppercase;
}

.config-add-btn-plus {
  font-family: var(--font-display);
  font-size: 40px;
  font-weight: 700;
  line-height: 1;
}

/* Footer — fixed to viewport, mirrors composer-container */
.config-editor-footer {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding: 20px var(--content-inset) 28px;
  background: var(--composer-bg);
  backdrop-filter: blur(16px);
  -webkit-backdrop-filter: blur(16px);
  z-index: 10;
}

.config-editor-footer::before,
.config-editor-footer::after {
  content: "";
  position: absolute;
  bottom: calc(100% + 14px);
  width: 20px;
  height: 20px;
  pointer-events: none;
}

.config-editor-footer::before {
  left: 14px;
  border-bottom: 2px solid var(--black);
  border-left: 2px solid var(--black);
}

.config-editor-footer::after {
  right: 14px;
  border-bottom: 2px solid var(--black);
  border-right: 2px solid var(--black);
}

/* Status bar — mirrors composer-root (input + send) */
.config-status-bar {
  display: flex;
  gap: 0;
  align-items: stretch;
}

.config-status-box {
  flex: 1;
  background: transparent;
  border: 1px solid var(--border-subtle);
  border-right: none;
  border-radius: 6px 0 0 6px;
  padding: 14px 18px;
  min-height: 0;
  display: flex;
  align-items: flex-start;
}

.config-status-empty {
  font-family: var(--font-body);
  font-style: italic;
  font-size: 16px;
  color: var(--text-dim);
  opacity: 0.6;
}

.config-status-changes {
  font-family: var(--font-mono);
  font-size: 12px;
  color: var(--text);
  letter-spacing: 0.02em;
}

/* Change log — vertical list with individual revert */
.config-changes {
  display: flex;
  flex-direction: column;
  gap: 4px;
  width: 100%;
}

.config-change-entry {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 3px 0;
}

/* Kind badge — matches config-impact-action style */
.config-change-kind {
  font-family: var(--font-mono);
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.08em;
  padding: 1px 5px;
  border: 1px solid;
  flex-shrink: 0;
}

.config-change-kind-added {
  color: #5a9a6a;
  border-color: #5a9a6a;
}

.config-change-kind-deleted {
  color: var(--red);
  border-color: var(--red);
}

.config-change-kind-modified {
  color: #d19a66;
  border-color: #d19a66;
}

.config-change-kind-reordered {
  color: var(--text-dim);
  border-color: var(--border-subtle);
}

.config-change-kind-error {
  color: var(--red);
  border-color: var(--red);
}

.config-change-error .config-change-name {
  color: var(--red);
  font-weight: 400;
}

/* Column name */
.config-change-name {
  font-family: var(--font-display);
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.06em;
  color: var(--text);
}

.config-change-deleted .config-change-name {
  color: var(--red);
}

/* Changed fields detail */
.config-change-detail {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-dim);
  letter-spacing: 0.02em;
}

/* Dismiss button */
.config-change-dismiss {
  background: none;
  border: none;
  color: var(--text-dim);
  font-family: var(--font-mono);
  font-size: 14px;
  line-height: 1;
  padding: 2px 4px;
  cursor: pointer;
  opacity: 0;
  transition: opacity 0.1s, color 0.1s;
  flex-shrink: 0;
}

.config-change-entry:hover .config-change-dismiss {
  opacity: 1;
}

.config-change-dismiss:hover {
  color: var(--red);
}

.config-editor-error {
  color: var(--red);
  font-family: var(--font-mono);
  font-size: 12px;
  font-weight: 600;
}

.config-apply-btn {
  background: var(--black);
  color: var(--cream);
  border: 1px solid var(--border-subtle);
  border-left: none;
  border-radius: 0 6px 6px 0;
  padding: 14px 24px;
  font-family: var(--font-display);
  font-size: 13px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  cursor: pointer;
  transition: opacity 0.15s;
  white-space: nowrap;
}

.config-apply-btn:hover:not(:disabled) {
  opacity: 0.8;
}

.config-apply-btn:disabled {
  background: var(--disabled-bg);
  color: var(--text-dim);
  cursor: default;
}

/* Reset — mirrors clear-button */
.config-reset-btn {
  margin-top: 10px;
  background: none;
  border: none;
  padding: 0;
  color: var(--text-dim);
  font-family: var(--font-mono);
  font-size: 11px;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  text-decoration: underline;
  text-underline-offset: 3px;
  cursor: pointer;
  transition: color 0.1s;
}

.config-reset-btn:hover {
  color: var(--red);
}

/* ===================================================
   CONFIG CARD — COLUMN-CARD STYLE
   =================================================== */

.config-card {
  display: flex;
  flex-direction: row;
  background: color-mix(in srgb, var(--column-color, var(--accent)) 6%, var(--surface));
  border: 3px solid var(--column-color, var(--red));
  box-shadow: 4px 4px 0 var(--column-color, var(--red));
  flex: 0 0 400px;
  width: 400px;
  min-height: 240px;
}

/* Toolbar with reorder + delete */
.config-card-toolbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 6px 8px;
}

.config-card-reorder {
  display: flex;
  gap: 2px;
}

.config-reorder-btn {
  background: none;
  border: none;
  color: var(--text-dim);
  font-family: var(--font-display);
  font-size: 14px;
  line-height: 1;
  padding: 4px 6px;
  cursor: pointer;
}

.config-reorder-btn:hover:not(:disabled) {
  color: var(--black);
}

.config-reorder-btn:disabled {
  opacity: 0.2;
  cursor: default;
}

.config-delete-btn {
  width: 28px;
  height: 28px;
  border: none;
  background: none;
  color: var(--text-dim);
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 700;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.config-delete-btn:hover:not(:disabled) {
  color: var(--red);
}

.config-delete-btn:disabled {
  opacity: 0.2;
  cursor: default;
}

.config-card-body {
  padding: 12px 14px;
  border-top: 1px dashed var(--black);
  display: flex;
  flex-direction: column;
  gap: 12px;
  overflow-y: auto;
}

.config-field {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.config-label {
  font-family: var(--font-display);
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-dim);
  display: flex;
  align-items: center;
  gap: 5px;
}

.config-label-hint {
  position: relative;
  color: var(--text-dim);
  cursor: help;
  font-size: inherit;
  font-weight: inherit;
}

.config-label-hint::after {
  content: attr(data-tip);
  position: absolute;
  left: 0;
  top: calc(100% + 6px);
  background: var(--black);
  color: var(--cream);
  font-family: var(--font-body);
  font-size: 11px;
  font-weight: 400;
  text-transform: none;
  letter-spacing: 0;
  line-height: 1.4;
  padding: 6px 8px;
  width: 200px;
  white-space: normal;
  z-index: 50;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.1s;
}

.config-label-hint:hover::after {
  opacity: 1;
}

.config-input {
  background: var(--cream);
  border: 2px solid var(--black);
  padding: 6px 10px;
  color: var(--text);
  font-family: var(--font-mono);
  font-size: 13px;
  outline: none;
}

.config-input:focus {
  box-shadow: inset 0 0 0 1px var(--black);
}

.config-textarea {
  background: var(--cream);
  border: 2px solid var(--black);
  padding: 8px 10px;
  color: var(--text);
  font-family: var(--font-mono);
  font-size: 12px;
  line-height: 1.5;
  resize: vertical;
  outline: none;
}

.config-textarea:focus {
  box-shadow: inset 0 0 0 1px var(--black);
}

.config-swatches {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
}

.config-swatch {
  width: 24px;
  height: 24px;
  border: 2px solid transparent;
  cursor: pointer;
  transition: border-color 0.1s;
}

.config-swatch:hover {
  border-color: var(--black);
}

.config-swatch.active {
  border-color: var(--black);
  box-shadow: var(--shadow-sm);
}

/* ===================================================
   CONTEXT EDITOR
   =================================================== */

.context-editor {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.context-editor-label {
  font-family: var(--font-display);
  font-size: 11px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: var(--text-dim);
}

.context-row {
  display: flex;
  gap: 6px;
  align-items: center;
  cursor: pointer;
  padding: 3px 0;
}

.context-row-unchecked {
  opacity: 0.45;
}

.context-checkbox {
  margin: 0;
  accent-color: var(--black);
  cursor: pointer;
}

.context-col-name {
  font-family: var(--font-mono);
  font-size: 12px;
  min-width: 60px;
}

.context-select {
  background: var(--cream);
  border: 2px solid var(--black);
  padding: 3px 6px;
  color: var(--text);
  font-family: var(--font-mono);
  font-size: 11px;
  outline: none;
}

.context-select:focus {
  box-shadow: inset 0 0 0 1px var(--black);
}

.context-mode {
  width: 76px;
}

.context-fixed {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-dim);
  width: 76px;
  padding: 3px 6px;
}

.config-pattern-hint {
  font-family: var(--font-mono);
  font-size: 11px;
  color: var(--text-dim);
  letter-spacing: 0.05em;
  margin-top: 4px;
  padding: 2px 0;
}

/* ===================================================
   INLINE IMPACT CONFIRMATION
   =================================================== */

.config-impact {
  display: flex;
  flex-direction: column;
  gap: 6px;
  width: 100%;
}

.config-impact-header {
  font-family: var(--font-body);
  font-size: 12px;
  color: var(--text-dim);
  margin-bottom: 2px;
}

.config-impact-entry {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  padding: 2px 0;
}

.config-impact-entry input[type="checkbox"] {
  width: 14px;
  height: 14px;
  accent-color: var(--black);
  flex-shrink: 0;
  cursor: pointer;
  margin: 0;
}

.config-impact-name {
  font-family: var(--font-display);
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--black);
}

.config-impact-action {
  font-family: var(--font-mono);
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  padding: 1px 5px;
  border: 1px solid;
}

.config-impact-deleted {
  color: var(--red);
  border-color: var(--red);
}

.config-impact-recomputed {
  color: #d19a66;
  border-color: #d19a66;
}

.config-impact-cascade {
  font-family: var(--font-mono);
  font-size: 10px;
  color: var(--text-dim);
  letter-spacing: 0.05em;
}

/* ===================================================
   API KEY OVERLAY
   =================================================== */

.api-key-overlay {
  position: fixed;
  inset: 0;
  background: var(--cream);
  z-index: 300;
  display: flex;
  align-items: center;
  justify-content: center;
}

.api-key-dialog {
  background: var(--surface);
  border: 3px solid var(--black);
  box-shadow: var(--shadow);
  width: 380px;
  max-width: calc(100vw - 32px);
  padding: 24px;
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.api-key-header {
  font-family: var(--font-display);
  font-size: 20px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.api-key-description {
  font-size: 13px;
  color: var(--text-dim);
  line-height: 1.5;
}

.api-key-input {
  font-family: var(--font-mono);
  font-size: 13px;
  padding: 10px 12px;
  border: var(--border-thick);
  background: var(--surface);
  outline: none;
}

.api-key-input:focus {
  box-shadow: var(--shadow-sm);
}

.api-key-submit {
  font-family: var(--font-display);
  font-size: 14px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  padding: 10px 16px;
  background: var(--black);
  color: var(--cream);
  border: var(--border-thick);
  cursor: pointer;
}

.api-key-submit:hover:not(:disabled) {
  background: var(--red);
}

.api-key-submit:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}
